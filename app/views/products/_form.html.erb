<%= form_for(@product, :html => {:multipart => true})  do |f| %>
  <% if @product.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@product.errors.count, "error") %> prohibited this listing from being saved:</h2>

      <ul>
      <% @product.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>


<!-- WHY DID I EMAIL MASK? -->
  <div class="form-group">
    <%= f.text_field :title, autofocus: true, placeholder: "Title", class: "form-control", id: "email-mask", required: true %>
  </div>

  <div class="form-group">
    <%= f.collection_select :category_id, Category.order(:category_name),:id,:category_name, {prompt: true, required: true}, {class: "form-control"} %>
  </div>

  <div class="form-group">
    <%= f.text_field :price, required: true, placeholder: "Price", class: "form-control" %>
  </div>

  <div class="form-group">
    <%= f.trix_editor :description, required: true, placeholder: "Description", rows: 20, class: "form-control" %>
  </div>

  <div class="form-group">
    <% if @product.images? %>
      <% @product.images.each do |p| %>
        <%= image_tag(p.url, class: "image-container-preview") %>
      <% end %>
    <% end %>
    <div id="preview"></div>
    </br>
    <%= f.file_field :images, :onchange => "previewFiles()", multiple: true, placeholder: "Image", accept: ".jpg, .jpeg, .gif, .png", class: "form-control", id: "image-form" %>
    <%= f.hidden_field :images_cache, multiple: true %>
  </div>
  <hr>
  <h5>Contact Preference</h5>
  <div class="row">
    <div class="col-sm-6">
      <div class="form-group">
        <%= f.check_box :contact_by_email, placeholder: "contact via email", rows: 10, class: "form-product-contact", disabled: true %>
        <%= current_user.email %>
        <br>
        <% if current_user.phone_number? %>
          <%= f.check_box :contact_by_phone, placeholder: "contact via phone", rows: 10, class: "form-product-contact", checked: true %>
          <%= current_user.phone_number %>
        <% else %>
          <%= f.check_box :contact_by_phone, placeholder: "contact via phone", rows: 10, class: "form-product-contact" %>
          <%= f.text_field :contact_pref, placeholder: "Description", rows: 10, class: "form-control" %>
        <% end %>
      </div>
    </div>
  </div>  

  <hr>
  <div class="form-group">
    <h6>Products will stay posted for <%= $days_posted %> days.</h6>
    <!-- language is in js -->
    <p id="fp"></p> 
    <% if @products > $max_products %>
      <h6>You can only have <%= $max_products %> products posted at once.</h6>
      <%= f.button "Post Product", class: "btn btn-primary", disabled: true, id: "product-submit-btn", style: "background-color: #{@market.first_color}; border-color: #{@market.first_color}" %>
    <% else %>
      <%= f.button "Post Product", class: "btn btn-primary", id: "product-submit-btn", 'data-disable-with' => "<i class='fa fa-spinner fa-spin'></i> Posting Product...".html_safe, style: "background-color: #{@market.first_color}; border-color: #{@market.first_color}" %>
    <% end %>
  </div>
<% end %>